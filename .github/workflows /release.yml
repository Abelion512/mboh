name: Release & Deploy

on:
  push:
      branches: [main]

      permissions:
        contents: write
          pages: write
            id-token: write

            jobs:
              release:
                  runs-on: ubuntu-latest
                      steps:
                            - uses: actions/checkout@v4
                                    with: { fetch-depth: 0 }
                                          - uses: actions/setup-node@v4
                                                  with: { node-version: '20' }

                                                        - run: npm ci
                                                              - name: Semantic Release
                                                                      env:
                                                                                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                                                                                        run: npx semantic-release

                                                                                              - name: Generate update-manifest
                                                                                                      run: npm run build:update-manifest

                                                                                                            # Publish ke GitHub Pages (static)
                                                                                                                  - name: Setup Pages
                                                                                                                          uses: actions/configure-pages@v5
                                                                                                                                - name: Upload artifact
                                                                                                                                        uses: actions/upload-pages-artifact@v3
                                                                                                                                                with:
                                                                                                                                                          path: .
                                                                                                                                                                - name: Deploy to Pages
                                                                                                                                                                        id: deployment
                                                                                                                                                                                uses: actions/deploy-pages@v4